The second half of each palindrome is defined by the first half. Work only with the half of each palindrome. Recursively count the number of palindromes for each prefix and construct the solution using binary search.